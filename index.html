<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SkillPath AI ‚Äî Career Intelligence</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@500;700;800&display=swap" rel="stylesheet">
  
  <style>
    /* --- 1. THEME VARIABLES (DEFAULT: COSMIC) --- */
    :root {
      --bg-color: #030014;
      --sidebar-bg: rgba(3, 0, 20, 0.95);
      --card-bg: rgba(255, 255, 255, 0.05);
      --card-border: rgba(255, 255, 255, 0.1);
      --text-main: #ffffff;
      --text-muted: #94a3b8;
      --accent-glow: rgba(139, 92, 246, 0.3);
      --primary: #8b5cf6;
      --secondary: #3b82f6;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --modal-overlay: rgba(0, 0, 0, 0.85);
      --blob-1: #7c3aed;
      --blob-2: #2563eb;
      --blob-3: #db2777;
    }

    [data-theme="emerald"] {
      --bg-color: #022c22;
      --sidebar-bg: rgba(6, 78, 59, 0.95);
      --card-bg: rgba(16, 185, 129, 0.05);
      --card-border: rgba(52, 211, 153, 0.2);
      --text-main: #ecfdf5;
      --text-muted: #6ee7b7;
      --primary: #10b981;
      --secondary: #34d399;
      --accent-glow: rgba(16, 185, 129, 0.4);
      --blob-1: #065f46; --blob-2: #047857; --blob-3: #064e3b;
    }

    [data-theme="sunset"] {
      --bg-color: #450a0a;
      --sidebar-bg: rgba(69, 10, 10, 0.95);
      --card-bg: rgba(255, 255, 255, 0.05);
      --card-border: rgba(251, 113, 133, 0.2);
      --text-main: #fff1f2;
      --text-muted: #fda4af;
      --primary: #f43f5e;
      --secondary: #fb923c;
      --accent-glow: rgba(244, 63, 94, 0.4);
      --blob-1: #be123c; --blob-2: #c2410c; --blob-3: #9f1239;
    }

    [data-theme="light"] {
      --bg-color: #f8fafc;
      --sidebar-bg: #ffffff;
      --card-bg: #ffffff;
      --card-border: #e2e8f0;
      --text-main: #0f172a;
      --text-muted: #64748b;
      --primary: #2563eb;
      --secondary: #4f46e5;
      --accent-glow: rgba(37, 99, 235, 0.1);
      --modal-overlay: rgba(255, 255, 255, 0.8);
      --blob-1: #bfdbfe; --blob-2: #ddd6fe; --blob-3: #e0e7ff;
    }

    * { box-sizing: border-box; transition: all 0.3s ease; }
    
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg-color);
      color: var(--text-main);
      height: 100vh;
      overflow: hidden;
    }

    .bg-mesh {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;
      background: 
        radial-gradient(circle at 15% 50%, var(--blob-1), transparent 50%),
        radial-gradient(circle at 85% 30%, var(--blob-2), transparent 50%),
        linear-gradient(180deg, var(--bg-color) 0%, var(--blob-3) 100%);
      filter: blur(60px);
      background-size: 150% 150%;
      animation: gradientMove 15s ease infinite;
    }
    @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

    .login-wrapper { display: flex; justify-content: center; align-items: center; height: 100vh; width: 100%; position: absolute; top: 0; left: 0; z-index: 999; background: var(--bg-color); backdrop-filter: blur(10px); }
    
    .login-box { 
        background: var(--card-bg); 
        border: 1px solid var(--card-border); 
        padding: 50px 40px; 
        border-radius: 24px; 
        width: 90%; max-width: 420px; 
        box-shadow: 0 20px 50px rgba(0,0,0,0.3); 
        text-align: center; 
        position: relative; overflow: hidden;
        backdrop-filter: blur(20px);
    }
    
    .app { display: none; grid-template-columns: 260px 1fr; height: 100vh; }
    .app.active-app { display: grid; }
    
    aside { background: var(--sidebar-bg); border-right: 1px solid var(--card-border); padding: 24px 16px; display: flex; flex-direction: column; z-index: 10; overflow-y: auto; }
    main { padding: 32px 48px; overflow-y: auto; scroll-behavior: smooth; }

    .brand { font-family: 'Outfit', sans-serif; font-size: 22px; font-weight: 800; color: var(--text-main); margin-bottom: 32px; display: flex; align-items: center; gap: 10px; }
    .nav-link { display: flex; align-items: center; gap: 12px; padding: 12px 14px; margin-bottom: 6px; border-radius: 12px; color: var(--text-muted); text-decoration: none; font-weight: 500; font-size: 14px; border: 1px solid transparent; cursor: pointer; }
    .nav-link:hover { background: var(--card-bg); color: var(--text-main); }
    .nav-link.active { background: rgba(139, 92, 246, 0.15); border: 1px solid var(--primary); color: var(--primary); }

    .card { background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 20px; padding: 32px; margin-bottom: 24px; position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.02); transition: transform 0.2s; }
    .card:hover { transform: translateY(-3px); }
    .grid-2 { display: grid; grid-template-columns: 1.5fr 1fr; gap: 24px; }
    .grid-4 { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
    
    .btn { padding: 12px 24px; border-radius: 10px; font-weight: 600; font-size: 14px; cursor: pointer; border: 1px solid var(--card-border); background: var(--card-bg); color: var(--text-main); text-decoration: none; display: inline-flex; align-items: center; justify-content: center; }
    .btn:hover { background: var(--card-border); filter: brightness(1.1); }
    .btn-primary { background: linear-gradient(135deg, var(--primary), var(--secondary)); border: none; color: #fff; box-shadow: 0 4px 15px var(--accent-glow); }
    
    .input-field { width: 100%; padding: 14px; border-radius: 10px; border: 1px solid var(--card-border); background: rgba(255,255,255,0.05); color: var(--text-main); font-size: 1rem; outline: none; margin-bottom: 15px; }
    .input-field:focus { border-color: var(--primary); background: rgba(255,255,255,0.1); }
    
    textarea.input-field { resize: vertical; min-height: 120px; font-family: 'Inter', sans-serif; line-height: 1.6; }

    .google-btn { background: white; color: #333; display: flex; align-items: center; justify-content: center; gap: 12px; width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: 600; font-size: 15px; cursor: pointer; margin-bottom: 20px; }
    .divider { display: flex; align-items: center; color: var(--text-muted); font-size: 12px; margin: 24px 0; }
    .divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: var(--card-border); margin: 0 10px; }
    .auth-toggle { margin-top: 25px; font-size: 14px; color: var(--text-muted); }
    .auth-toggle a { color: var(--primary); cursor: pointer; font-weight: 600; margin-left: 5px; }
    .error-msg { color: var(--error); font-size: 13px; margin-bottom: 15px; display: none; background: rgba(239,68,68,0.1); padding: 8px; border-radius: 6px; }

    .hide { display: none !important; }
    .fade-in { animation: fadeIn 0.5s ease forwards; opacity: 0; transform: translateY(10px); }
    @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
    
    .input-select { width: 100%; padding: 14px; border-radius: 10px; border: 1px solid var(--card-border); background: rgba(255,255,255,0.05); color: var(--text-main); font-size: 1rem; outline: none; margin-bottom: 15px; appearance: none; }
    .input-select option { background-color: var(--bg-color); color: var(--text-main); }
    
    .score-circle { width: 120px; height: 120px; border-radius: 50%; background: conic-gradient(var(--primary) 0deg, var(--card-border) 0deg); display: flex; align-items: center; justify-content: center; position: relative; margin: 0 auto 20px auto; }
    .score-circle::before { content: ''; position: absolute; width: 100px; height: 100px; background: var(--bg-color); border-radius: 50%; }
    .score-value { position: relative; font-size: 32px; font-weight: 800; font-family: 'Outfit', sans-serif; }
    .criteria-item { display: flex; align-items: center; justify-content: space-between; padding: 12px; border-bottom: 1px solid var(--card-border); }

    .ticker-container { margin-bottom: 30px; border-radius: 12px; background: rgba(139, 92, 246, 0.05); border: 1px solid var(--card-border); overflow: hidden; padding: 10px; position: relative; z-index: 5; }
    .ticker-wrapper { display: flex; width: fit-content; animation: scroll 40s linear infinite; }
    .ticker-item { margin: 0 20px; color: var(--text-muted); text-decoration: none; font-size: 13px; font-weight: 500; display: inline-flex; align-items: center; gap: 5px; white-space: nowrap; cursor: pointer; }
    @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

    .loader { border: 3px solid rgba(255,255,255,0.1); border-top: 3px solid var(--primary); border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 0 auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    .theme-panel { margin-top: 20px; padding: 15px; border-top: 1px solid var(--card-border); }
    .theme-title { font-size: 12px; color: var(--text-muted); margin-bottom: 10px; font-weight: 600; text-transform: uppercase; }
    .theme-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
    .theme-btn { width: 30px; height: 30px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: transform 0.2s; }

    .login-input { width: 100%; padding: 14px; margin-bottom: 15px; border-radius: 10px; border: 1px solid var(--card-border); background: rgba(0,0,0,0.2); color: var(--text-main); font-size: 1rem; outline: none; transition: 0.2s; }

    .player-layout { display: grid; grid-template-columns: 280px 1fr; gap: 20px; height: 65vh; }
    .module-sidebar { border-right: 1px solid var(--card-border); padding-right: 20px; overflow-y: auto; }
    .module-btn { display: block; width: 100%; text-align: left; padding: 15px; border-radius: 10px; margin-bottom: 8px; background: transparent; border: 1px solid transparent; color: var(--text-muted); cursor: pointer; font-size: 14px; transition: 0.2s; }
    .module-btn.active { background: rgba(139, 92, 246, 0.1); border-color: var(--primary); color: white; font-weight: 600; }
    
    .content-viewer { padding: 0 20px; overflow-y: auto; line-height: 1.7; }
    
    .quiz-option { padding: 16px; margin-bottom: 8px; border-radius: 10px; cursor: pointer; background: var(--card-bg); border: 1px solid var(--card-border); color: var(--text-main); transition: 0.2s; font-weight: 500; width: 100%; text-align: left;}
    .quiz-option.correct { background: rgba(16, 185, 129, 0.1); border-color: #10b981; color: #10b981; }
    .quiz-option.wrong { background: rgba(239, 68, 68, 0.1); border-color: #ef4444; color: #ef4444; }
    
    .tag { padding: 4px 12px; border-radius: 20px; background: var(--card-bg); border: 1px solid var(--card-border); font-size: 12px; color: var(--text-main); }
    
    .chart-bar { height: 150px; display: flex; align-items: flex-end; gap: 10px; justify-content: space-between; padding-top:20px;}
    .bar { width: 100%; background: rgba(139,92,246,0.2); border-radius: 4px; position: relative; }

    .platform-card { background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 16px; padding: 20px; text-align: center; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.2s; }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--modal-overlay); backdrop-filter: blur(8px); z-index: 1000; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
    .modal-overlay.active { opacity: 1; pointer-events: all; }
    .modal-content { background: var(--bg-color); border: 1px solid var(--card-border); padding: 40px; border-radius: 24px; max-width: 500px; width: 90%; text-align: center; transform: translateY(20px); transition: transform 0.3s; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
    .modal-img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--primary); margin-bottom: 20px; object-fit: cover; }
    
    .progress-widget { background: var(--card-bg); border: 1px solid var(--card-border); padding: 15px; border-radius: 12px; margin-top: auto; margin-bottom: 20px; }
    .progress-bar-bg { height: 6px; width: 100%; background: rgba(255,255,255,0.1); border-radius: 10px; margin-top: 8px; overflow: hidden; }
    .progress-fill { height: 100%; width: 0%; background: var(--primary); border-radius: 10px; transition: width 0.5s ease; }

    .chat-box { height: 350px; overflow-y: auto; background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-bottom: 15px; display: flex; flex-direction: column; gap: 10px; border: 1px solid var(--card-border); }
    .msg { padding: 10px 15px; border-radius: 12px; max-width: 80%; font-size: 14px; line-height: 1.5; }
    .msg-ai { align-self: flex-start; background: rgba(255,255,255,0.1); color: var(--text-main); border-bottom-left-radius: 2px; }
    .msg-user { align-self: flex-end; background: var(--primary); color: white; border-bottom-right-radius: 2px; }

    .camera-modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:2000; display:none; flex-direction:column; align-items:center; justify-content:center; backdrop-filter: blur(10px); }
    .camera-video { width: 90%; max-width: 500px; border-radius: 12px; border: 2px solid var(--primary); transform: scaleX(-1); margin-bottom: 20px; box-shadow: 0 0 20px var(--primary); }

    .path-step-card { border-left: 4px solid var(--primary); padding: 20px; background: var(--card-bg); border-radius: 10px; margin-bottom: 15px; position: relative; }
    .path-step-num { position: absolute; top: -10px; left: -10px; background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; box-shadow: 0 4px 10px var(--accent-glow); }
    .resource-btn { display: inline-block; margin-top: 10px; padding: 6px 12px; font-size: 12px; background: rgba(255,255,255,0.05); color: var(--text-muted); border: 1px solid var(--card-border); border-radius: 20px; text-decoration: none; transition: 0.2s; }

    .ats-score-container { margin-top: 20px; background: rgba(0,0,0,0.2); border-radius: 10px; height: 20px; width: 100%; position: relative; overflow: hidden; }
    .ats-score-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--error), var(--warning), var(--success)); transition: width 1s ease-out; }
    .keyword-badge { display: inline-block; padding: 5px 10px; margin: 3px; border-radius: 15px; font-size: 12px; font-weight: bold; }
    .keyword-missing { background: rgba(239, 68, 68, 0.2); color: var(--error); border: 1px solid var(--error); }

  </style>
</head>
<body>

  <div class="bg-mesh"></div>

  <div id="login-view" class="login-wrapper">
      <div class="login-box fade-in">
          <div class="brand" style="justify-content:center; font-size:28px; margin-bottom: 10px;">SkillPath <span>AI</span></div>
          <h2 id="authTitle" style="margin-bottom: 5px; margin-top: 0; color: var(--text-main);">Welcome back</h2>
          <p style="font-size: 14px; margin-bottom: 25px; color: var(--text-muted);">Enter your details to access your dashboard.</p>
          
          <button onclick="handleGoogleLogin()" class="google-btn">
             <span>Sign in with Google</span>
          </button>

          <div class="divider">OR</div>
          <div id="loginError" class="error-msg">Incorrect credentials.</div>

          <input type="text" id="loginUser" class="login-input" placeholder="Username (admin)" required>
          <input type="password" id="loginPass" class="login-input" placeholder="Password (12345)" required>
          <button onclick="handleLoginClick()" class="btn btn-primary" style="width:100%;">Log In</button>
          
          <div class="auth-toggle">
              <span id="toggleText">Don't have an account?</span> <a onclick="toggleAuthMode()">Sign up</a>
          </div>
          <div style="margin-top:20px; font-size:12px; color:var(--text-muted); opacity: 0.6;">Demo: Use <strong>admin</strong> / <strong>12345</strong></div>
      </div>
  </div>

  <div id="app-view" class="app">
    <aside>
      <div class="brand">SkillPath <span>AI</span></div>
      <nav>
        <a onclick="nav('overview')" id="btn-overview" class="nav-link active">üìä Overview</a>
        <a onclick="nav('dashboard')" id="btn-dashboard" class="nav-link">üìà My Dashboard</a>
        <a onclick="nav('trending')" id="btn-trending" class="nav-link">üî• Trending Courses</a>
        <a onclick="nav('eligibility')" id="btn-eligibility" class="nav-link">‚úÖ Eligibility</a>
        <a onclick="nav('skills')" id="btn-skills" class="nav-link">üíº Skill Matcher</a>
        <a onclick="nav('interview')" id="btn-interview" class="nav-link">üé§ AI Interview (Real)</a>
        <a onclick="nav('resume')" id="btn-resume" class="nav-link">üìÑ ATS Checker (Text)</a>
        <a onclick="nav('salary')" id="btn-salary" class="nav-link">üí∞ Salary AI</a>
        <a onclick="nav('profile')" id="btn-profile" class="nav-link">üë§ Profile</a>
        <a onclick="nav('recommendations')" id="btn-recommendations" class="nav-link">üéØ My Path (AI)</a>
        <a onclick="nav('mentorship')" id="btn-mentorship" class="nav-link">üí¨ Mentors</a>
        <a onclick="nav('jobs')" id="btn-jobs" class="nav-link">üíº Live Jobs</a>
      </nav>

      <div class="progress-widget">
         <div style="display:flex; justify-content:space-between; font-size:12px; color:var(--text-main); font-weight:600;"><span>Profile Strength</span><span id="progText">0%</span></div>
         <div class="progress-bar-bg"><div id="progBar" class="progress-fill"></div></div>
      </div>

      <div class="theme-panel">
          <div class="theme-title">Select Theme</div>
          <div class="theme-grid">
              <div onclick="setTheme('default')" class="theme-btn active" style="background:#030014;" title="Cosmic"></div>
              <div onclick="setTheme('emerald')" class="theme-btn" style="background:#022c22;" title="Emerald"></div>
              <div onclick="setTheme('sunset')" class="theme-btn" style="background:#450a0a;" title="Sunset"></div>
              <div onclick="setTheme('light')" class="theme-btn" style="background:#f8fafc;" title="Light"></div>
          </div>
      </div>

      <button class="btn" style="margin-top:10px; border-color: #ef4444; color:#ef4444;" onclick="logout()">Log Out</button>
    </aside>

    <main>
      <div class="ticker-container fade-in">
        <div class="ticker-wrapper" id="liveTicker"></div>
      </div>

      <div id="view-overview" class="view-section fade-in">
        <div class="grid-2">
          <div class="card">
            <span style="font-size: 12px; font-weight: 800; color: var(--primary); letter-spacing: 1px;">AI CAREER ACCELERATOR</span>
            <h1>Align your skills<br>to the future.</h1>
            <p>Personalized learning paths, live market data, and expert mentorship.</p>
            <div style="display:flex; gap: 12px;">
              <button onclick="nav('eligibility')" class="btn btn-primary">Check Eligibility</button>
              <button onclick="nav('jobs')" class="btn">Browse Jobs</button>
            </div>
          </div>
          <div class="card"><h3>üìà Live Trends (24h)</h3><div id="trendList"></div></div>
        </div>
        <h3 style="margin-top: 40px; margin-bottom: 20px;">Featured Mentors</h3>
        <div class="grid-2" id="homeMentorGrid"></div>
      </div>

      <div id="view-dashboard" class="view-section hide fade-in">
          <div class="grid-2">
              <div class="card">
                  <h3>Weekly Activity</h3>
                  <div class="chart-bar">
                      <div class="bar" style="height:40%;"><span>M</span></div>
                      <div class="bar" style="height:60%;"><span>T</span></div>
                      <div class="bar" style="height:30%;"><span>W</span></div>
                      <div class="bar" style="height:80%; background:var(--success);"><span>T</span></div>
                      <div class="bar" style="height:50%;"><span>F</span></div>
                      <div class="bar" style="height:20%;"><span>S</span></div>
                      <div class="bar" style="height:10%;"><span>S</span></div>
                  </div>
              </div>
              <div class="card">
                  <h3>Current Status</h3>
                  <div style="margin-top:20px;">
                      <div class="criteria-item"><span style="color:var(--text-muted);">Courses Completed</span><span id="dashCompleted" style="font-weight:bold;">0</span></div>
                      <div class="criteria-item"><span style="color:var(--text-muted);">XP Earned</span><span id="dashXP" style="font-weight:bold;">0</span></div>
                      <div class="criteria-item" style="border:none;"><span style="color:var(--text-muted);">Skills Gained</span><span id="dashSkills" style="color:var(--success); font-weight:bold;">0</span></div>
                  </div>
              </div>
          </div>
      </div>

      <div id="view-trending" class="view-section hide fade-in">
          <h3>üî• Featured Career Paths</h3>
          <p style="color:var(--text-muted); margin-bottom:30px;">Top 30+ Industry-Standard Courses.</p>
          <div class="grid-4" id="trendingGrid"></div>
      </div>

      <div id="view-eligibility" class="view-section hide fade-in">
        <div class="grid-2">
            <div class="card">
                <h3>Check Role Eligibility</h3>
                <label style="font-size:14px; color:var(--text-muted);">Target Role</label>
                <select id="eligRole" class="input-select">
                    <option value="Frontend Developer">Frontend Developer</option>
                    <option value="Data Scientist">Data Scientist</option>
                    <option value="Backend Engineer">Backend Engineer</option>
                    <option value="UI/UX Designer">UI/UX Designer</option>
                </select>
                <input type="text" id="eligSkills" class="input-field" placeholder="Your skills (e.g. React, Python)">
                <input type="number" id="eligExp" class="input-field" placeholder="Years of Experience">
                <button onclick="calculateEligibility()" class="btn btn-primary" style="width:100%;">Calculate Score</button>
            </div>
            <div class="card" id="eligResult" style="display:none; text-align:center;">
                <h3>Eligibility Score</h3>
                <div class="score-circle"><div class="score-value" id="scoreValue">0%</div></div>
                <div id="scoreText">Calculating...</div>
                <div style="margin-top:30px; text-align:left;">
                    <div class="criteria-item"><span>Skill Match</span><span id="resSkills">-</span></div>
                    <div class="criteria-item"><span>Experience</span><span id="resExp">-</span></div>
                    <div class="criteria-item"><span>Missing</span><span id="resMissing" style="color:var(--warning);">-</span></div>
                </div>
                <button onclick="showImprovementPlan()" class="btn" style="width:100%; margin-top:20px;">Get AI Course Plan</button>
            </div>
        </div>
      </div>

      <div id="view-skills" class="view-section hide fade-in">
        <div class="card" style="max-width: 900px; margin: 0 auto;">
          <h2>Skill-Based Job Matcher</h2>
          <div style="display:flex; gap:10px;">
              <input type="text" id="skillSearchInput" class="input-field" placeholder="e.g. React, Node.js">
              <button onclick="searchJobsBySkills()" class="btn btn-primary">Find Matches</button>
          </div>
          <div id="skillJobLoader" class="loader hide" style="margin-top:30px;"></div>
          <div id="skillJobResults" class="grid-2" style="margin-top:30px;"></div>
        </div>
      </div>

      <div id="view-interview" class="view-section hide fade-in">
          <div class="card" style="height: 80vh; display: flex; flex-direction: column;">
              <h3>AI Interview Coach</h3>
              <div id="chatBox" class="chat-box" style="flex:1;">
                  <div class="msg msg-ai">Hello! I am your AI Recruiter. Tell me about yourself.</div>
              </div>
              <div style="display:flex; gap:10px;">
                  <input type="text" id="chatInput" class="input-field" placeholder="Type your answer..." onkeypress="if(event.key==='Enter') sendChat()">
                  <button onclick="sendChat()" class="btn btn-primary">Send</button>
              </div>
          </div>
      </div>

      <div id="view-resume" class="view-section hide fade-in">
          <div class="card" style="max-width: 900px; margin: 0 auto;">
              <h2>ATS Resume Checker</h2>
              <div class="grid-2">
                  <textarea id="resumeText" class="input-field" placeholder="Paste full resume text here..."></textarea>
                  <textarea id="jobDesc" class="input-field" placeholder="Paste job description here..."></textarea>
              </div>
              <button onclick="scanResume()" class="btn btn-primary" style="width:100%; margin-top:20px;">Check ATS Score</button>
              <div id="resumeLoader" class="loader hide" style="margin-top:20px;"></div>
              <div id="resumeResult" class="hide">
                  <div class="card">
                      <div style="display:flex; justify-content:space-between;">
                          <h3>Match Score</h3>
                          <div id="atsScoreDisplay" style="font-size:24px; font-weight:bold;">0/100</div>
                      </div>
                      <div class="ats-score-container"><div id="atsScoreFill" class="ats-score-fill"></div></div>
                  </div>
                  <div class="grid-2">
                      <div class="card"><h4>‚ö†Ô∏è Missing Keywords</h4><div id="missingKeywords"></div></div>
                      <div class="card"><h4>‚ú® Feedback</h4><div id="resumeFeedback"></div></div>
                  </div>
              </div>
          </div>
      </div>

      <div id="view-salary" class="view-section hide fade-in">
          <div class="grid-2">
              <div class="card">
                  <h3>Salary Negotiator</h3>
                  <input type="text" id="salRole" class="input-field" value="Frontend Developer">
                  <button onclick="negotiateSalary()" class="btn btn-primary" style="width:100%;">Generate Script</button>
              </div>
              <div class="card"><div id="salaryResult" style="white-space: pre-wrap;">Script will appear here...</div></div>
          </div>
      </div>

      <div id="view-profile" class="view-section hide fade-in">
        <div class="card" style="max-width: 600px; margin: 0 auto;">
          <h2>Edit Profile</h2>
          <div style="text-align:center;">
              <img id="profileImg" src="https://i.pravatar.cc/150" style="width:120px; height:120px; border-radius:50%; object-fit:cover;">
              <div style="margin-top:15px;">
                  <label for="pfpUpload" class="btn">üìÇ Upload</label>
                  <input type="file" id="pfpUpload" style="display:none;" onchange="updatePFP(this)">
              </div>
          </div>
          <input id="profileNameInput" type="text" class="input-field" placeholder="Name">
          <input id="profilePhone" type="tel" class="input-field" placeholder="Phone">
          <input id="profileLoc" type="text" class="input-field" placeholder="City">
          <input id="profileTitle" type="text" class="input-field" placeholder="Title">
          <button onclick="saveProfile()" class="btn btn-primary" style="width:100%;">Save</button>
        </div>
      </div>

      <div id="view-learning" class="view-section hide fade-in">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
            <button onclick="nav('trending')" class="btn">‚Üê Back</button>
            <h2 id="playerCourseTitle">Course Title</h2>
        </div>
        <div class="card" style="padding:0;">
            <div class="player-layout">
                <div class="module-sidebar" id="moduleList"></div>
                <div class="content-viewer">
                    <div id="learnContent"></div>
                    <div id="quizArea" class="hide">
                        <h3>üß† Quiz</h3>
                        <h4 id="quizQuestion"></h4>
                        <div id="quizOptions"></div>
                        <div id="quizFeedback"></div>
                    </div>
                </div>
            </div>
        </div>
      </div>

      <div id="view-jobs" class="view-section hide fade-in">
        <h3>Live Jobs</h3>
        <div id="jobsContent" class="grid-2"></div>
      </div>
      
      <div id="view-mentorship" class="view-section hide fade-in">
        <h3>Available Mentors</h3>
        <div id="fullMentorList" class="grid-2"></div>
      </div>

    </main>
  </div>

  <script>
    /* --- SHARED VARIABLES --- */
    let chatHistory = [];
    let currentCourse = null;
    let userProfile = { name: "Guest", email: "guest@skillpath.ai", phone: "", location: "", title: "Learner", completedCourses: [], xp: 0 };

    /* --- NAVIGATION --- */
    function nav(pageId) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.add('hide'));
        document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
        const target = document.getElementById('view-' + pageId);
        if (target) target.classList.remove('hide');
        const btn = document.getElementById('btn-' + pageId);
        if (btn) btn.classList.add('active');
        if(pageId === 'trending') loadTrending();
        if(pageId === 'mentorship') loadMentors();
    }

    /* --- THEMES --- */
    function setTheme(theme) {
        document.body.setAttribute('data-theme', theme);
        document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
    }

    /* --- AUTH & PROFILE --- */
    function handleLoginClick() {
        const u = document.getElementById('loginUser').value;
        const p = document.getElementById('loginPass').value;
        if(u === "admin" && p === "12345") {
            document.getElementById('login-view').classList.add('hide');
            document.getElementById('app-view').classList.add('active-app');
            updateDashboard();
        } else {
            document.getElementById('loginError').style.display = 'block';
        }
    }

    function handleGoogleLogin() { window.location.href = "/auth/google"; }

    function saveProfile() {
        userProfile.name = document.getElementById('profileNameInput').value;
        userProfile.phone = document.getElementById('profilePhone').value;
        userProfile.location = document.getElementById('profileLoc').value;
        userProfile.title = document.getElementById('profileTitle').value;
        updateDashboard();
        alert("Profile Saved!");
    }

    function updatePFP(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = e => {
                document.getElementById('profileImg').src = e.target.result;
                localStorage.setItem('sp_pfp', e.target.result);
                updateDashboard();
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    /* --- AI INTERVIEW --- */
    async function sendChat() {
      const input = document.getElementById('chatInput');
      const box = document.getElementById('chatBox');
      const text = input.value;
      if(!text) return;
      box.innerHTML += `<div class="msg msg-user">${text}</div>`;
      input.value = '';
      chatHistory.push({ role: 'user', content: text });
      
      try {
        const res = await fetch('/api/interview', {
            method: 'POST', 
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ message: text, history: chatHistory })
        });
        const data = await res.json();
        chatHistory.push({ role: 'ai', content: data.reply });
        box.innerHTML += `<div class="msg msg-ai">${data.reply}</div>`;
        box.scrollTop = box.scrollHeight;
      } catch(e) { 
          box.innerHTML += `<div class="msg msg-ai" style="color:var(--error)">AI connection failed. Check your Render logs.</div>`;
      }
    }

    /* --- ATS CHECKER --- */
    async function scanResume() {
        const resumeText = document.getElementById('resumeText').value;
        const jobDesc = document.getElementById('jobDesc').value;
        const loader = document.getElementById('resumeLoader');
        const resBox = document.getElementById('resumeResult');

        if(!resumeText) return alert("Paste resume text.");
        loader.classList.remove('hide');
        resBox.classList.add('hide');

        try {
            const prompt = `Act as an ATS Scanner. Analyze Resume: "${resumeText.substring(0, 2000)}" against JD: "${jobDesc.substring(0, 1000)}". Return JSON: {"score": 0, "missing_keywords": [], "feedback": ""}`;
            const res = await fetch('/api/interview', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ role: "ATS Scanner", message: prompt, history: [] })
            });
            const data = await res.json();
            let cleanJson = data.reply.replace(/```json/g, '').replace(/```/g, '').trim();
            const result = JSON.parse(cleanJson);

            loader.classList.add('hide');
            resBox.classList.remove('hide');
            document.getElementById('atsScoreDisplay').innerText = result.score + "/100";
            document.getElementById('atsScoreFill').style.width = result.score + "%";
            document.getElementById('missingKeywords').innerHTML = result.missing_keywords.map(k => `<span class="keyword-badge">${k}</span>`).join('');
            document.getElementById('resumeFeedback').innerText = result.feedback;
        } catch (e) { loader.classList.add('hide'); alert("Error analyzing resume."); }
    }

    /* --- SALARY --- */
    async function negotiateSalary() {
        const role = document.getElementById('salRole').value;
        const box = document.getElementById('salaryResult');
        box.innerHTML = "Generating...";
        try {
            const res = await fetch('/api/salary-negotiate', {
                method: 'POST', 
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ role: role })
            });
            const data = await res.json();
            box.innerHTML = data.script;
        } catch (e) { box.innerHTML = "Error generating script."; }
    }

    /* --- JOB MATCHER --- */
    async function searchJobsBySkills() {
        const skills = document.getElementById('skillSearchInput').value;
        const loader = document.getElementById('skillJobLoader');
        const container = document.getElementById('skillJobResults');
        if (!skills) return;
        
        loader.classList.remove('hide');
        container.innerHTML = '';
        try {
            const res = await fetch('/api/find-jobs', { 
                method: 'POST', 
                headers: {'Content-Type': 'application/json'}, 
                body: JSON.stringify({ role: skills }) 
            });
            const jobs = await res.json();
            loader.classList.add('hide');
            container.innerHTML = jobs.map(job => `<div class="card"><h3>${job.title}</h3><p>${job.company}</p></div>`).join('');
        } catch (e) { loader.classList.add('hide'); }
    }

    /* --- DASHBOARD STATS --- */
    function updateDashboard() {
        let score = 0;
        if(userProfile.name !== "Guest") score += 20;
        if(userProfile.phone) score += 20;
        if(userProfile.location) score += 20;
        if(userProfile.title !== "Learner") score += 20;
        if(localStorage.getItem('sp_pfp')) score += 10;
        if(userProfile.completedCourses.length > 0) score += 10;
        
        document.getElementById('progText').innerText = score + "%";
        document.getElementById('progBar').style.width = score + "%";
        document.getElementById('dashCompleted').innerText = userProfile.completedCourses.length;
        document.getElementById('dashXP').innerText = userProfile.xp;
    }

    /* --- MOCKS & INITIAL DATA --- */
    function loadTrending() {
        const grid = document.getElementById('trendingGrid');
        grid.innerHTML = '<div class="card"><h3>React Basics</h3><p>3 Modules</p></div><div class="card"><h3>Python for AI</h3><p>5 Modules</p></div>';
    }

    function loadMentors() {
        const grid = document.getElementById('fullMentorList');
        grid.innerHTML = '<div class="card"><h3>Sarah J.</h3><p>Google AI Lead</p></div><div class="card"><h3>David K.</h3><p>MLOps Expert</p></div>';
    }

    window.onload = async () => {
        try {
            const res = await fetch('/api/current_user');
            const data = await res.json();
            if (data.success) {
                userProfile.name = data.user.username;
                document.getElementById('login-view').classList.add('hide');
                document.getElementById('app-view').classList.add('active-app');
                updateDashboard();
            }
        } catch (e) { console.log("Guest mode active."); }
    };
  </script>
</body>
</html>